import{j as m,F as v,J as b,a as w,r as p,b as y,d as N,R as F,c as S}from"./vendor.231fa463.js";const D=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}};D();const t=m.exports.jsx,a=m.exports.jsxs,u=m.exports.Fragment;function C({isVisible:e}){return e?t(u,{children:a("div",{className:"fixed top-0 left-0 right-0 bottom-0 w-full h-screen z-50 overflow-hidden bg-gray-700 opacity-80 flex flex-col items-center justify-center",children:[t("div",{style:{borderTopColor:"transparent"},className:"animate-spin inline-block w-14 h-14 border-4 p-4 rounded-full",role:"status"}),t("h2",{className:"text-center text-white text-xl font-semibold mt-4",children:"Creating files..."}),t("p",{className:"w-1/3 text-center text-white",children:"This may take a few seconds, please don't close this page."})]})}):null}var j="./assets/gradientRight.e0451430.svg",R="./assets/gradientLeft.99257c65.svg";const k=({text:e})=>(e[0],e.length>1?t(u,{children:a("div",{className:"w-full h-full flex flex-col absolute top-0 left-0 justify-center items-center px-3",children:[t("div",{className:"text-4xl font-medium ",children:e[0]}),t("div",{className:"text-xl font-light",children:e[1]})]})}):t(u,{children:t("div",{className:"w-full h-full flex absolute top-0 left-0 justify-center items-center text-4xl font-medium",children:e[0]})})),g=({subHeaderText:e,gradientSide:n})=>a("div",{className:"w-full relative",children:[t(k,{text:e}),t("div",{children:t("img",{src:n==="right"?j:R,className:"object-cover w-full",alt:"gradient top"})})]}),O=({button:e,children:n})=>t("div",{className:"content-between break-words w-full -mt-8 sm:pb-8",children:a("div",{className:"text-left items-center rounded-lg shadow-2xl w-full mx-auto max-w-3xl pb-10",children:[t("div",{className:"flex",children:n}),t("div",{className:"text-center pt-3",children:t("button",{type:"button",className:"bg-orange-400 hover:bg-orange-500 text-white font-bold py-2 px-4 rounded",onClick:s=>{s.preventDefault(),e.function(e.input)},children:"Download all files"})})]})}),L=({children:e})=>a("div",{className:"w-full px-8 py-8 items-center",children:[t("div",{className:"text-xl font-normal py-3 text-center",children:"See all your converted files"}),t("div",{className:"border border-1 border-gray-300 rounded-lg relative overflow-auto max-h-48",children:e})]}),A=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z"})}),M=({file:e,name:n})=>t("li",{className:"",children:a("button",{type:"button",className:"w-full flex gap-x-3 justify-center p-3 hover:bg-gray-200",onClick:()=>{v.exports.saveAs(e,n+".docx")},children:[t("span",{className:"text-base text-gray-500",children:n}),t(A,{})]})},n),V=e=>{const n=b();for(const s in e)n.file(`${s}.docx`,e[s]);n.generateAsync({type:"blob"}).then(s=>{const r=`combined-docs-${new Date().getTime()}.zip`;return w.saveAs(s,r)})};function U({mergedDocs:e,isVisible:n}){const s={input:e,function:V},l=["Voil\xE1!","Your DOCs have been created"],o=(i=>{const d=[];for(const c in i)d.push(t(M,{file:i[c],name:c}));return d})(e);return n?a(u,{children:[t(g,{subHeaderText:l,gradientSide:"left"}),t(O,{button:s,children:t(L,{children:t("ul",{className:"w-full rounded-lg text-gray-500 divide-y divide-solid",children:o.map(i=>i)})})})]}):null}const E=()=>{alert("Please select two valid files")},H=({uploadButton:e,children:n})=>t("div",{className:"content-between break-words w-full -mt-8 sm:p-8",children:a("div",{className:"text-left items-center rounded-lg shadow-2xl w-full mx-auto max-w-3xl pb-10",children:[t("div",{className:"flex",children:n}),t("div",{className:"text-center pt-3",children:t("button",{type:"button",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:s=>{s.preventDefault(),e.input.csvFile&&e.input.docFile?e.function(e.input):E()},children:"Generate files"})})]})}),x=({fileType:e,setFile:n})=>{let s,l;return e==="csv"?(s="Upload your CSV File",l=".csv"):(s="Upload your WORD File",l=".docx"),a("div",{className:"w-1/2 px-8 py-8 items-center",children:[t("div",{className:"text-xl font-normal py-3 text-center",children:s}),t("div",{className:"border border-dashed  border-2 border-gray-300 rounded-lg relative",children:t("input",{type:"file",className:"cursor-pointer relative block opacity-30 w-full h-full p-20",accept:l,onChange:r=>n(r.target.files[0])})})]})},T=({uploadFilesButton:e,setCsvFile:n,setDocFile:s,isVisible:l})=>l?a(u,{children:[t(g,{subHeaderText:["Create DOCs from Spreadsheet Data"],gradientSide:"right"}),a(H,{uploadButton:e,children:[t(x,{fileType:"csv",setFile:n}),t(x,{fileType:"doc",setFile:s})]})]}):null,B=()=>{const[e,n]=p.exports.useState(),[s,l]=p.exports.useState(),[r,o]=p.exports.useState(),[i,d]=p.exports.useState(!1),[c,f]=p.exports.useState(!1);return a(u,{children:[t(T,{uploadFilesButton:{input:{csvFile:e,docFile:s,setMergedDocs:o,setIsUploadSpinnerVisible:d,setIsResultsVisible:f},function:I},setCsvFile:n,setDocFile:l,isVisible:!c}),t(C,{isVisible:i}),t(U,{mergedDocs:r,isVisible:c})]})},I=async({csvFile:e,docFile:n,setMergedDocs:s,setIsUploadSpinnerVisible:l,setIsResultsVisible:r})=>{l(!0);const o=await P(e),i=z(o),d=await W(n),c=await $(d,i);s(c),setTimeout(function(){r(!0),l(!1)},200)},P=async e=>await e.text(),z=e=>{const n=Z(e),s=e.slice(0,e.indexOf(`
`)).replace(/\r/g,"").split(n);return e.slice(e.indexOf(`
`)+1,e.length).replace(/\r/g,"").split(`
`).map(o=>{const i=o.split(n);return s.reduce((c,f,h)=>(c[f]=i[h],c),{})})},Z=e=>{const n=e.slice(0,e.indexOf(`
`)).replace(/\r/g,"");return n.includes(";")?";":(n.includes(","),",")},W=async e=>{const n=new FileReader;return new Promise((s,l)=>{n.onerror=()=>{n.abort(),l(new DOMException("Problem parsing input file."))},n.onload=()=>{s(n.result)},n.readAsBinaryString(e)})},$=async(e,n)=>{const s={};for(const l of n){const r=new y(e),o=new N(r,{paragraphLoop:!0,linebreaks:!0}),i=J(l);o.render(l);const d=o.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});s[i]=d}return s},J=e=>Object.values(e).slice(0,4).join("-");var q="./assets/logo.d3e328be.png";function G(){return a("div",{className:"bg-white shadow-sm font-sans flex flex-col text-right w-full sm:flex-row sm:justify-between py-4 px-6 sm:items-center",children:[t("div",{className:"mr-auto",children:t("a",{href:"/",children:t("img",{className:"block h-10 w-auto",src:q,alt:"app logo"})})}),t("div",{className:"flex items-center space-x-10",children:t("a",{className:"text-black text-center",href:"mailto:document.generator.office@gmail.com",children:"Contact Us"})})]})}function K(){return a("div",{className:"App bg-white min-h-screen",children:[t(G,{}),t(B,{})]})}F.render(t(S.StrictMode,{children:t(K,{})}),document.getElementById("root"));
